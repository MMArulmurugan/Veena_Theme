{% liquid
    assign current_variant = product.selected_or_first_available_variant
    assign featured_image = current_variant.image | default: product.featured_image
    assign secondary_image = product.images[1] | default: product.featured_image
    assign discountAmount = current_variant.compare_at_price | minus: current_variant.price
    assign discountPercentage = discountAmount | times: 100 | divided_by: current_variant.compare_at_price
  %}


  {% style %}
    .relative-container {
        position: relative;
    }

    .product-card__quick-view {
        top: 10px; 
        right: 10px; 
    }
    .product-card__info{
        text-align:center;
        display:flex;
        flex-direction:column;
        justify-content:center;
        align-items:center;
        line-height: 28.8px;
    }
    .product-card__form{
        margin-bottom:0;
    }
    .product-card__title{
        text-decoration:none;
    }
    .product-card__title:hover{
        color:#d03c3f;
    }
    .product-card__list{
        list-style-type:none;
        display:flex;
    }
    .product-card__max-stock{
        color:green;
    }
    .product-card__min-stock{
        color:red;
    }
    .product-card_badge-container{
        top: 0;
        left:0;
        display:flex;
        flex-direction:column;
        padding:10px;
        
    }
    .product-card_badge{
        background: green;
        margin: 5px;
        color: white;
    }
    .product-card__dicound{
        background:#d03c3f;
        color: white;
        margin: 5px;
    }
    .quick-view-button {
        font-size:12px;
        padding: 5px;
    }
    .product-card__color-dot{
        margin-right:10px;
        border-radius: 50%;
        cursor:pointer;
        height: 30px;
        width: 30px;
    }

    /* Hide the default radio input */
    input[type="radio"] {
        display: none;
    }

    /* Style the label to act as a replacement for the radio button */
    .product-card__color-dot label {
        width: 20px; /* Set the width and height according to your design */
        height: 20px;
        background-color: #000; /* Set the background color you want */
        display: inline-block;
        cursor: pointer;
        border-radius: 50%;
    }

    /* Add a border or any other styling to indicate the selected state */
    


   
  {% endstyle %}
  
  <product-card 
    class="product-card"
    data-product-handle="{{ product.handle }}" 
    data-section-id="{{ section_id }}"
  >
    <a href="{{ product.url }}" class="product-card__link position-relative">
      
        {% render 'image' desktopImage:featured_image, class: "media media--portrait custom-border-radius  media--transparent media--hover-effect " %} 
      
       <div class="product-card__quick-view position-absolute">
        {% form 'product', product %}
          <input type="hidden" name="id" value="{{ current_variant.id }}">
          <button type="submit" class="button quick-view-button custom-button-secondary_color">Quick View</button>
        {% endform %}
      </div>
      
      <div class = "product-card_badge-container position-absolute">
        {% for tag in product.tags %}
            {% if tag contains 'New' %}
              {% assign badge_text = tag | split: '_' | last %}
            {% endif %}
          {% endfor %}
          {% if badge_text != blank %}
            <span class="badge product-card_badge ">
              {{ badge_text }}
            </span>
          {% endif %}
    
          {% if discountPercentage %}
            <span class="product-card__dicound badge ">{{ discountPercentage}}% off</span> 
           {% endif %} 
      </div>

    </a>
  
    <div class="product-card__info">
          
        <div class="product-card__form">
            {% form 'product', product %}   
            <input type="hidden" name="id" value="{{ current_variant.id }}">  
                {% unless product.has_only_default_variant %}
                    <div class="product-card__options"> 
                    {% for product_option in product.options_with_values %}
                        {%  if product_option.name == "Color" %}                           
                            <div class="product-card__option"> 
                                <ul class = "product-card__list item-swatch">
                                    {% for option_value in product_option.values %}
                                        <li data-value={{option_value}} class = "product-card__color-dot" >
                                            <input 
                                                id = "{{ current_variant.id | append: option_value }}"
                                                type="radio" 
                                                name="option-{{ product_option.name | handleize }}" 
                                                value="{{ option_value }}"
                                                
                                                {% if product_option.selected_value == option_value %}checked{% endif %}
                                            >
                                            <label data-value="{{ option_value }}" for = "{{ current_variant.id | append: option_value }}"> </label>    
                                            
                                        </li>                                    
                                    {% endfor %}
                                </ul>
                            </div>
                        {% endif %} 
                    {% endfor %}
                    </div>
                {% endunless %}          
            {% endform %}
        </div>

        
        <span>{{ product.vendor }}</span>

        <a href="{{ product.url }}" class="product-card__title h3">{{ product.title }}</a>     
  
        <div class="product-card__prices">

                {% if product.price_varies %}
                  <span class="h3"> From {{ product.price_min | money_with_currency }}</span>
                {% else %}
                  <span class="h3">  {{ product.price | money_with_currency }}</span>   
                {% endif %}                
    
                {% if current_variant.compare_at_price > current_variant.price %}
                <s class="product-card__compareprice">{{ current_variant.compare_at_price | money_without_trailing_zeros }}</s>
                {% endif %}
        </div>
       
      {% if current_variant.inventory_quantity > 10 %}
        <span class = "product-card__max-stock">{{ current_variant.inventory_quantity }}  in stock</span>
      {% else %} 
        <span class = "product-card__min-stock">Only {{ current_variant.inventory_quantity }}  units left</span>
      {% endif %}  
      
      
      
      
    </div>
  
    <script>
      {{ product.variants | json }}
    </script>
  </product-card>

  <script src="{{ 'product-card.js' | asset_url }}" defer></script>