{% liquid
    assign current_variant = product.selected_or_first_available_variant
    assign featured_image = current_variant.image | default: product.featured_image
    assign secondary_image = product.images[1] | default: product.featured_image
    assign discountAmount = current_variant.compare_at_price | minus: current_variant.price
    assign discountPercentage = discountAmount | times: 100 | divided_by: current_variant.compare_at_price
  %}

  
  {% style %}
  
  {% endstyle %}
  
  <product-card 
    class="product-card"
    data-product-handle="{{ product.url | within: collection }}" 
    data-section-id="{{ section_id }}"
  >
    <a href="{{ product.url }}" class="product-card__link position-relative">

      <div class="image-hover-swap product-card__image custom-border-radius">
        {% render 'image',
          desktopImage: featured_image,
          class: 'media media--portrait'
        %}
        <div class="product-card__secondary-image">
          {% render "image", desktopImage: secondary_image, class:"media media--portrait" %}
        </div>
      </div>
      
      {% if current_variant.inventory_quantity != 0 %}
        <div class="product-card__quick-view position-absolute">
          {% form 'product', product %}
            <input type="checkbox" name="addToCart" id="addToCartCheckbox" value="{{ current_variant.id }}">
          {% endform %}
        </div>
     {% endif %} 
      
      <div class = "product-card_badge-container position-absolute">
          {% for tag in product.tags %}
            {% if tag contains 'New' %}
              {% assign badge_text = tag | split: '_' | last %}
            {% endif %}
          {% endfor %}
          {% if badge_text != blank %}
            <span class="badge product-card_badge ">
              {{ badge_text }}
            </span>
          {% endif %}
          {% if current_variant.inventory_quantity == 0 %}
            <span class="product-card__sold-out badge ">sold out</span> 
          {% endif %}
          {% if discountPercentage %}
            <span class="product-card__dicound badge ">{{ discountPercentage}}% off</span> 
           {% endif %} 
      </div>

    </a>
  
    <div class="product-card__info">
       
        <a href="{{ product.url }}" class="product-card__title">{{ product.title }}</a>     
  
        <div class="product-card__prices">
          {% if product.price_varies %}
            <span class="product-card__price-amount"> From {{ product.price_min | money_with_currency }}</span>
          {% else %}
            <span class="product-card__price-amount">  {{ product.price | money_with_currency }}</span>   
          {% endif %}                

          {% if current_variant.compare_at_price > current_variant.price %}
          <s class="product-card__compareprice">{{ current_variant.compare_at_price | money_without_trailing_zeros }}</s>
          {% endif %}
        </div>
       
      
    </div>
  
    <script>
      {{ product.variants | json }}
    </script>
  </product-card>

  